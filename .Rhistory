library(httr)
library(jsonlite)
library(ggplot2)
library(DescTools)
library(tidyverse)
library(magrittr)
library(rlang)
library(lubridate)
library(anytime)
library(readr)
library(yaml)
setwd("~/Bildung/Technische Universit√§t Berlin/Master/Auslandssemester/Courses/BAN400/Assignments/Assignment 6 - Iterations/iterations-maltekasiske")
# Load function for posting GQL-queries and retrieving data:
source("functions/GQL_function.r")
configs <-
read_yaml("vegvesen_configs.yml")
gql_metadata_qry <- read_file("gql-queries/station_metadata.gql")
stations_metadata <-
GQL(
query=gql_metadata_qry,
.url = configs$vegvesen_url
)
View(stations_metadata)
str(stations_metadata)
View(stations_metadata)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
View(stations_metadata)
str(stations_metadata)
library(purrr)
library(purrr)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
class(stations_metadata)
View(stations_metadata)
str(stations_metadata)
transform_metadata_to_df <- function(metadata_list) {
# Extract the trafficRegistrationPoints list
traffic_points_list <- metadata_list$trafficRegistrationPoints
# Create an empty data frame to store the results
result_df <- data.frame()
# Iterate over each element in the traffic points list
for (point in traffic_points_list) {
# Extract data from the current point
id <- point$id
name <- point$name
latest_data <- point$latestData$volumeByHour
lat <- point$location$coordinates$latLon$lat
lon <- point$location$coordinates$latLon$lon
# Create a data frame for the current point
point_df <- data.frame(id, name, latest_data, lat, lon)
# Append the point data frame to the result data frame
result_df <- rbind(result_df, point_df)
}
# Convert the latest_data column to POSIXct in UTC
result_df$latest_data <- anytime(result_df$latest_data)
return(result_df)
}
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
View(stations_metadata_df)
source("functions/data_tests.r")
test_stations_metadata(stations_metadata_df)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_tests.r")
test_stations_metadata(stations_metadata_df)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_tests.r")
test_stations_metadata(stations_metadata_df)
View(stations_metadata_df)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
View(stations_metadata_df)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_tests.r")
test_stations_metadata(stations_metadata_df)
source("functions/data_transformations.r")
stations_metadata_df <-
stations_metadata %>%
transform_metadata_to_df(.)
source("functions/data_tests.r")
test_stations_metadata(stations_metadata_df)
